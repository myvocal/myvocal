(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{104:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(0),i=n.n(r),c=n(18),s=n.n(c),o=(n(74),n(7)),l=n.n(o),u=n(13),h=n(12),d=n(14),f=n(24),v=n(23),b=n(59),j=n.n(b),p=n(30),g=n(50),m=["C","D\u266d","D","E\u266d","E","F","G\u266d","G","A\u266d","A","B\u266d","B"],x=[[121,85,72],[158,158,158],[96,125,139],[76,175,80],[244,67,54],[33,150,243],[0,150,136],[255,235,59],[0,188,212]];function y(e){var t=Math.log(e/440)/Math.log(2)*12;return Math.round(t)+69}function O(e,t){return Math.floor(1200*Math.log(e/function(e){return 440*Math.pow(2,(e-69)/12)}(t))/Math.log(2))}function C(e){var t=Math.floor(e/12)-1,n=Math.min(t,x.length-1);return n=Math.max(0,n),x[n]}var w=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15e3;Object(h.a)(this,e),this.frequencies=[],this.melodyNotes=[],this.background="#efefef",this.highlight="#888888",this.container=t,this.container.style.position="relative";var a="position: absolute; width: 100%; height: 100%;";this.bgCanvas=document.createElement("canvas"),this.bgCanvas.setAttribute("style",a),this.bgContext=this.bgCanvas.getContext("2d"),this.melodyCanvas=document.createElement("canvas"),this.melodyCanvas.setAttribute("style",a),this.melodyContext=this.melodyCanvas.getContext("2d"),this.noteCanvas=document.createElement("canvas"),this.noteCanvas.setAttribute("style",a),this.noteContext=this.noteCanvas.getContext("2d"),this.container.appendChild(this.bgCanvas),this.container.appendChild(this.melodyCanvas),this.container.appendChild(this.noteCanvas),this.timeSpan=n,this.lastSongPos=0,this.speedChanged=void 0,this.playingSpeed=0,this.resize()}return Object(d.a)(e,[{key:"resize",value:function(){var e=this.container.clientWidth,t=this.container.clientHeight;this.bgCanvas.width=e,this.bgCanvas.height=t,this.melodyCanvas.width=e,this.melodyCanvas.height=t,this.noteCanvas.width=e,this.noteCanvas.height=t,this.scaleX=Object(g.a)().domain([-this.timeSpan/2,this.timeSpan/2]).range([0,e]);var n=t/(m.length+1);this.scaleY=Object(g.a)().domain([0,m.length-1]).range([t-n,n]),this.render()}},{key:"pushFrequency",value:function(e){this.frequencies.push(e)}},{key:"cleanupFrequencies",value:function(){var e=this;this.frequencies=this.frequencies.filter((function(t){return e.now-t.time<e.timeSpan/2}))}},{key:"setMelodyNotes",value:function(e){this.melodyNotes=e}},{key:"playSong",value:function(){this.changePlayingSpeed(1)}},{key:"fastForwardSong",value:function(){this.changePlayingSpeed(3)}},{key:"pauseSong",value:function(){this.changePlayingSpeed(0)}},{key:"calculateSongPos",value:function(e){return this.lastSongPos+this.playingSpeed*(e-this.speedChanged)}},{key:"changePlayingSpeed",value:function(e){var t=(new Date).getTime();void 0===this.speedChanged&&(this.speedChanged=t),this.lastSongPos=this.calculateSongPos(t),this.playingSpeed=e,this.speedChanged=t}},{key:"render",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.now=(new Date).getTime();var t=this.calculateSongPos(this.now);this.cleanupFrequencies(),e&&this.drawBackground(),this.drawMelody(t),this.drawNotes()}},{key:"setBackgroundColor",value:function(e){this.background=e,this.drawBackground()}},{key:"setHighlightColor",value:function(e){this.highlight=e,this.drawBackground()}},{key:"drawBackground",value:function(){var e=this.bgCanvas.width,t=this.bgCanvas.height;this.bgContext.fillStyle=this.background,this.bgContext.clearRect(0,0,e,t),this.bgContext.fillRect(0,0,e,t);for(var n=0;n<m.length;++n){var a=this.scaleY(n);this.bgContext.fillStyle=this.highlight+"55",this.bgContext.fillRect(0,a,e,1),this.bgContext.fillStyle=this.highlight,this.bgContext.font="14px Sans",this.bgContext.fillText(m[n],this.scaleX(0)+20,a-2)}this.bgContext.fillStyle=this.highlight+"55",this.bgContext.fillRect(this.scaleX(0),0,1,t)}},{key:"drawNotes",value:function(){var e=this.noteCanvas.width,t=this.noteCanvas.height;this.noteContext.clearRect(0,0,e,t),this.noteContext.beginPath(),this.noteContext.strokeStyle="rgba(0, 0, 0, 0.1)";var n,a=[],r=Object(p.a)(this.frequencies);try{for(r.s();!(n=r.n()).done;){var i=n.value,c=i.time,s=i.frequency,o=i.clarity,l=y(s),u=O(s,l),h=this.scaleX(c-this.now),d=this.scaleY(l%12+u/100),f=C(l);a.push({time:c,x:h,y:d,clarity:o,color:f})}}catch(D){r.e(D)}finally{r.f()}this.noteContext.beginPath();for(var v=1;v<a.length;++v){var b=a[v],j=b.x,g=b.y;b.time-a[v-1].time>500?(this.noteContext.stroke(),this.noteContext.beginPath(),this.noteContext.moveTo(j,g)):this.noteContext.lineTo(j,g)}this.noteContext.stroke();for(var m=0,x=a;m<x.length;m++){var w=x[m],S=w.x,k=w.y,N=w.clarity,M=w.color;this.noteContext.fillStyle="rgba(".concat(M[0],", ").concat(M[1],", ").concat(M[2],", ").concat(.5*N,")"),this.noteContext.beginPath(),this.noteContext.arc(S,k,3,0,2*Math.PI),this.noteContext.fill()}}},{key:"drawMelody",value:function(e){var t=this.melodyCanvas.width,n=this.melodyCanvas.height,a=this.melodyContext;a.clearRect(0,0,t,n),a.strokeStyle="rgba(0, 255, 0, 1)",a.lineWidth=n/24;var r,i=Object(p.a)(this.melodyNotes);try{for(i.s();!(r=i.n()).done;){var c=r.value,s=c.start,o=c.duration,l=c.pitch,u=this.scaleX(s-e),h=this.scaleX(s-e+o),d=this.scaleY(l%12);a.beginPath(),a.moveTo(u,d),a.lineTo(h,d),a.stroke()}}catch(f){i.e(f)}finally{i.f()}}}]),e}(),S=n(60);function k(e){var t=e.onPress,n=e.onRelease,r=e.style;return Object(a.jsx)("div",{style:r,onMouseDown:t,onMouseUp:n,children:"FAST FORWARD"})}function N(e){var t=e.onPress,n=e.onRelease,r=e.style;return Object(a.jsx)("div",{style:r,onMouseDown:t,onMouseUp:n,children:"PAUSE"})}var M=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).displayElement=i.a.createRef(),e.pitchDisplay=void 0,e.lastRender=0,e.continuousUpdate=!0,e.notes=void 0,e.onResize=function(){e.pitchDisplay&&e.pitchDisplay.resize()},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.readNotes(),this.pitchDisplay=new w(this.displayElement.current,6e3),this.pitchDisplay.setBackgroundColor("#F5F5F5"),this.pitchDisplay.setMelodyNotes(this.notes),this.pitchDisplay.playSong();!function t(){e.updatePitch(),e.continuousUpdate&&requestAnimationFrame(t)}(),window.addEventListener("resize",this.onResize)}},{key:"componentWillUnmount",value:function(){this.continuousUpdate=!1,window.removeEventListener("resize",this.onResize)}},{key:"readNotes",value:function(){this.notes=[];var e=j.a.parse(window.location.search.substr(1));if(e.s1)try{this.notes=Object(S.a)(e.s1)}catch(t){alert(t.toString())}}},{key:"updatePitch",value:function(){var e=(new Date).getTime();if(!(e-this.lastRender<17)&&this.pitchDisplay){var t=this.props,n=t.freq,a=t.clarity;n&&n>0&&this.pitchDisplay.pushFrequency({frequency:n,clarity:a||0,time:e}),this.lastRender=e,this.pitchDisplay.render(!1)}}},{key:"render",value:function(){var e=this;this.updatePitch();return Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsx)("div",{className:"full",style:{position:"relative"},ref:this.displayElement}),Object(a.jsx)(N,{onPress:function(){return e.pitchDisplay.pauseSong()},onRelease:function(){return e.pitchDisplay.playSong()},style:{position:"absolute",bottom:40,left:80}}),Object(a.jsx)(k,{onPress:function(){return e.pitchDisplay.fastForwardSong()},onRelease:function(){return e.pitchDisplay.playSong()},style:{position:"absolute",bottom:40,right:40}})]})}}]),n}(r.Component),D=n(10);function R(e){var t=e.stream,n=e.detectorName,r=e.workerConnection,c=e.windowSize,s=e.powerThreshold,o=e.clarityThreshold,h=e.enabled,d=e.pitchRenderer,f=i.a.useState(null),v=Object(D.a)(f,2),b=v[0],j=v[1],p=i.a.useState(null),g=Object(D.a)(p,2),m=g[0],x=g[1],y=i.a.useRef(!1),O=i.a.useRef({}),C=i.a.useCallback(Object(u.a)(l.a.mark((function e(){var a,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.remoteHandle().call("createDetector",n,c,c/2);case 2:(a=O.current).buffer=new Float32Array(c),a.audioContext=new AudioContext,i=a.audioContext.createMediaStreamSource(t),a.analyser=a.audioContext.createAnalyser(),a.analyser.fftSize=c,i.connect(a.analyser);case 9:case"end":return e.stop()}}),e)}))),[O,c,n,t,r]),w=i.a.useCallback(Object(u.a)(l.a.mark((function e(){var t,n,a,i,c,u,h;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y.current){e.next=15;break}if(y.current=!0,t=O.current,n=t.analyser,a=t.buffer,i=t.audioContext,n&&a&&i){e.next=7;break}return console.warn("Trying to update the pitch, but missing an analyser/buffer/audioContext"),e.abrupt("return");case 7:return n.getFloatTimeDomainData(a),e.next=10,r.remoteHandle().call("getPitch",a,i.sampleRate,s,o);case 10:c=e.sent,u=c[0],h=c[1],u>0?(j(u),x(h)):(j(null),x(null)),y.current=!1;case 15:case"end":return e.stop()}}),e)}))),[y,O,j,x,s,o,r]);i.a.useEffect((function(){if(h){console.log("Starting audio monitoring.");var e={cancelRender:!1};return Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:t();case 3:case"end":return e.stop()}}),e)})))(),function(){console.log("Stopping audio monitoring."),e.cancelRender=!0}}function t(){e.cancelRender||(requestAnimationFrame(t),w())}}),[C,w,h]);var S=d;return Object(a.jsx)(S,{freq:b,clarity:m})}var P=Math.log2(440);function T(e,t,n,a){e=(e%(2*Math.PI)+2*Math.PI)%(2*Math.PI);var r=Math.PI,i=Math.tan,c=Math.atan,s=Math.sqrt,o=Math.sin,l=Math.cos,u=0,h=0;if(0===t)return[u,h];var d=c(n/2/(t+a/2)),f=c(n/2/(t+a/2));if(e<0+d||e>2*r-d)u=t,h=-(t+n/2)*i(e)-a/2;else if(e>r-d&&e<r+d)u=-t-n,h=-(t+n/2)*i(r-e)-a/2;else if(e>r/2-f&&e<r/2+f)u=s(n*n/4+(t+a/2)*(t+a/2))*o(r/2-e)-n/2,h=-(t+a);else if(e>3*r/2-f&&e<3*r/2+f)u=s(n*n/4+(t+a/2)*(t+a/2))*o(r/2-e)-n/2,h=t;else if(e>=0+d&&e<=r/2-f){var v=s(n*n/4+a*a/4),b=t,j=e-c(a/n),p=s(b*b+(l(j)*l(j)-1)*v*v)+l(j)*v;u=p*l(e)-n/2,h=-(p*o(e)+a/2)}else if(e>=r/2+f&&e<=r-d){e=r-e;var g=s(n*n/4+a*a/4),m=t,x=e-c(a/n),y=s(m*m+(l(x)*l(x)-1)*g*g)+l(x)*g;u=-(y*l(e)-n/2)-n,h=-(y*o(e)+a/2)}else if(e>=r+d&&e<=3*r/2-f){e-=r;var O=s(n*n/4+a*a/4),C=t,w=e-c(a/n),S=s(C*C+(l(w)*l(w)-1)*O*O)+l(w)*O;u=-S*l(e)-n/2,h=S*o(e)-a/2}else if(e>=3*r/2+f&&e<=2*r-d){e=2*r-e;var k=s(n*n/4+a*a/4),N=t,M=e-c(a/n),D=s(N*N+(l(M)*l(M)-1)*k*k)+l(M)*k;u=D*l(e)-n/2,h=D*o(e)-a/2}return[u,h]}var E={C:"C",Db:"C\u266f",D:"D",Eb:"D\u266f",E:"E",F:"F",Gb:"F\u266f",G:"G",Ab:"G\u266f",A:"A",Bb:"A\u266f",B:"B"},F={C:"C",Db:"D\u266d",D:"D",Eb:"E\u266d",E:"E",F:"F",Gb:"G\u266d",G:"G",Ab:"A\u266d",A:"A",Bb:"B\u266d",B:"B"};function z(e){var t=e.hz,n="sharp"===e.noteFormat?E:F,r=function(e){for(var t=Object.keys(E),n=Math.log2(e)-P,a=Math.floor(n)+4,r=((n-.25)%1+1)%1,i=0;i<12;i++)if(r>i/12-1/24&&r<=i/12+1/24)return{note:t[i],octave:a};return{note:"C",octave:a}}(t),i=r.note,c=r.octave;return Object(a.jsxs)("div",{className:"freq-container",children:[Object(a.jsxs)("span",{className:"freq-note",children:[n[i],Object(a.jsx)("span",{className:"freq-octave",children:c})]}),Object(a.jsxs)("span",{className:"freq-hz",children:[Math.round(t)," Hz"]})]})}var A=i.a.memo((function(e){var t=e.w,n=e.h,r=e.noteFormat,c=void 0===r?"sharp":r,s=i.a.useRef(null),o=i.a.useRef([{current:null},{current:null},{current:null},{current:null},{current:null},{current:null},{current:null},{current:null},{current:null},{current:null},{current:null},{current:null}]),l=t/2,u=n/2,h=Math.min(t,n)/3,d=.6*h,f="sharp"===c?E:F,v=Object.keys(f);return i.a.useEffect((function(){var e,a=null===(e=s.current)||void 0===e?void 0:e.getContext("2d");if(a){!function(e,t){var n,a,r=Object(D.a)(t,2),i=r[0],c=r[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=0,l=i/2,u=c/2,h=null!==(n=s.outerR)&&void 0!==n?n:Math.min(i,c)/3,d=null!==(a=s.innerR)&&void 0!==a?a:.6*h,f=new Path2D;f.arc(l,u,h,0,2*Math.PI),f.moveTo(l+d,u),f.arc(l,u,d,0,2*Math.PI),e.fillStyle="rgb(204,204,240)",e.fill(f,"evenodd"),e.strokeStyle="rgb(110,102,102)";for(var v=new Path2D,b=0;b<60;b++){var j=b/60*2*Math.PI-o,p=.5;b%5===0&&(p=1);var g=Math.cos(j),m=Math.sin(j);v.moveTo(g*h+l,m*h+u),v.lineTo(g*(1-.08*p)*h+l,m*(1-.08*p)*h+u)}e.lineWidth=2,e.stroke(v),e.lineWidth=1,e.stroke(f)}(a,[t,n],{innerR:d,outerR:h});for(var r=0;r<12;r++){var i=-r/12*2*Math.PI+Math.PI/2+0,c=o.current[r];if(c.current){var f=c.current,v=f.getBoundingClientRect(),b=v.width,j=v.height,p=T(i,h+4,b,j),g=Object(D.a)(p,2),m=g[0],x=g[1];f.style.left="".concat(m+l,"px"),f.style.top="".concat(x+u,"px")}}}}),[t,n,c,l,u,d,h,0]),Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsx)("canvas",{width:t,height:n,ref:s,className:"freq-background"}),o.current.map((function(e,t){return Object(a.jsx)("div",{ref:e,className:"freq-note-label",children:f[v[t]]},t)}))]})}));function q(e){var t=e.freq,n=void 0===t?440:t,r=(e.clarity,i.a.useState(400)),c=Object(D.a)(r,2),s=c[0],o=c[1],l=i.a.useState(400),u=Object(D.a)(l,2),h=u[0],d=u[1],f=i.a.useRef(null),v=i.a.useRef(null),b=function(e,t){var n=Math.min(e,t)/3;return{innerR:.6*n,outerR:n}}(s,h),j=b.innerR,p=b.outerR,g=function(e){return((Math.log2(e)-P-.5)%1+1)%1*Math.PI*2}(n||440);return i.a.useLayoutEffect((function(){function e(){var e=f.current;if(e){var t=e.getBoundingClientRect(),n=t.width,a=t.height;o(n),d(a)}}return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[o,d,f]),i.a.useEffect((function(){if(v.current){var e=v.current.getContext("2d");e&&function(e,t,n){var a=Object(D.a)(t,2),r=a[0],i=a[1],c=n.angle,s=n.opacity,o=n.innerR,l=n.outerR,u=[Math.cos(c),Math.sin(c)],h=u[0],d=u[1],f=-d,v=h;e.moveTo(h*o+3*f+r/2,i/2-(d*o+3*v)),e.lineTo(h*o-3*f+r/2,i/2-(d*o-3*v)),e.lineTo(h*l+r/2,-d*l+i/2),e.fillStyle="rgba(0,128,204,".concat(s,")"),e.fill(),e.strokeStyle="rgba(0,77,204,".concat(s,")"),e.lineJoin="bevel",e.stroke()}(e,[s,h],{angle:0,opacity:.8,innerR:j,outerR:p})}}),[s,h,j,p]),Object(a.jsxs)("div",{ref:f,className:"freq-surround",children:[Object(a.jsx)(A,{w:s,h:h,noteFormat:"sharp"}),n&&Object(a.jsx)(z,{hz:n||440,noteFormat:"sharp"}),Object(a.jsx)("canvas",{className:"freq-pointer",width:s,height:h,ref:v,style:{transformOrigin:"center",transform:"rotate(".concat(g,"rad)"),visibility:n?"visible":"hidden"}})]})}var I=n(116),B=n(118),L=n(112),W=n(113),G=n(114),U=n(115),H=n(9),X=n(51),J=Object(H.createStore)({windowSize:1024,detectorName:"mcleod",displayType:"chart",clarityThreshold:.5,enabled:!1,loading:!1,loaded:!1,stream:null,audioOptions:{audio:{echoCancellation:!0,autoGainControl:!0}},workerConnection:null,setWindowSize:Object(H.action)((function(e,t){e.windowSize=t})),setDetectorName:Object(H.action)((function(e,t){e.detectorName=t})),setDisplayType:Object(H.action)((function(e,t){e.displayType=t})),setClarityThreshold:Object(H.action)((function(e,t){e.clarityThreshold=t})),setEnabled:Object(H.action)((function(e,t){e.enabled=t})),setStream:Object(H.action)((function(e,t){e.stream=t})),setLoading:Object(H.action)((function(e,t){e.loading=t})),setLoaded:Object(H.action)((function(e,t){e.loaded=t})),setWorkerConnection:Object(H.action)((function(e,t){e.workerConnection=t})),initializeStream:Object(H.thunk)(function(){var e=Object(u.a)(l.a.mark((function e(t,n,a){var r,i,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.getState,i=r(),c=i.audioOptions,t.setLoading(!0),e.prev=4,e.next=7,navigator.mediaDevices.getUserMedia(c);case 7:s=e.sent,t.setStream(s),t.setLoading(!1),t.setLoaded(!0),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(4),console.error(e.t0),t.setStream(null),t.setLoading(!1),t.setLoaded(!1);case 19:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,n,a){return e.apply(this,arguments)}}()),stopStream:Object(H.thunk)(function(){var e=Object(u.a)(l.a.mark((function e(t,n,a){var r,i,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.getState,i=r().stream){c=Object(p.a)(i.getTracks());try{for(c.s();!(s=c.n()).done;)s.value.stop()}catch(n){c.e(n)}finally{c.f()}}t.setStream(null),t.setLoading(!1),t.setLoaded(!1);case 6:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()),initializeWorker:Object(H.thunk)(function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Worker("".concat("/myvocal","/pitch-detection/worker.js")),a=new X.b({worker:n}),e.prev=2,e.next=5,Object(X.a)(a,{},5,1e3);case 5:r=e.sent,t.setWorkerConnection(r),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.error("Failed to connect to worker",e.t0),t.setWorkerConnection(null);case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}())}),Y=Object(H.createTypedHooks)(),_=Y.useStoreActions,K=(Y.useStoreDispatch,Y.useStoreState),Q=n(52),V=n(53),Z=(n(97),n(98),i.a.createContext({expanded:!1,toggleExpanded:function(){}}));function $(){var e=i.a.useContext(Z),t=e.expanded,n=e.toggleExpanded;return Object(a.jsx)("div",{className:"sidenav-toggle",children:Object(a.jsx)("button",{className:"hamburger hamburger--squeeze ".concat(t?"is-active":""),type:"button","aria-label":"Menu","aria-controls":"navigation",onClick:n,children:Object(a.jsx)("span",{className:"hamburger-box",children:Object(a.jsx)("span",{className:"hamburger-inner"})})})})}function ee(e){var t=e.children,n=Object(V.a)(e,["children"]),r=n.className,i=Object(V.a)(n,["className"]);return r="sidenav-item "+(r||""),Object(a.jsx)("div",Object(Q.a)(Object(Q.a)({className:r},i),{},{children:t}))}function te(e){var t=e.children;return Object(a.jsx)("button",{className:"sidenav-icon",children:t})}function ne(e){var t=e.children;return Object(a.jsx)("div",{className:"sidenav-text",children:t})}function ae(e){var t=e.children;return Object(a.jsx)("div",{className:"sidenav-extra",children:t})}var re=Object.assign((function(e){var t=e.expanded,n=e.onToggle,r=e.children,c=i.a.useState(t||!1),s=Object(D.a)(c,2),o=s[0],l=s[1];return null!=t&&(o=t),Object(a.jsx)(Z.Provider,{value:{expanded:o,toggleExpanded:function(){l(!o),n&&n(!o)}},children:Object(a.jsx)("nav",{className:"sidenav ".concat(o?"expanded":""),children:r})})}),{Nav:function(e){var t=e.children;return Object(a.jsx)("div",{className:"sidenav-nav",children:t})},NavItem:ee,NavIcon:te,NavText:ne,NavExtra:ae}),ie=n(111),ce=n(64),se=n(117);function oe(e){var t=e.selected,n=e.onSelect,r=e.choices,c=i.a.useState(t),s=Object(D.a)(c,2),o=s[0],l=s[1];null!=t&&(o=t);var u=Math.max(r.findIndex((function(e){return e.value===o})),0);return Object(a.jsx)(ie.a,{onSelect:function(e){l(r[e].value),n&&n(r[e].value)},title:r[u].desc,variant:"outline-light",as:"span",children:null===r||void 0===r?void 0:r.map((function(e,t){var n=e.desc;return Object(a.jsx)(ce.a.Item,{eventKey:""+t,children:n},t)}))})}function le(){var e=K((function(e){return e.windowSize})),t=_((function(e){return e.setWindowSize}));return Object(a.jsx)(oe,{selected:e,onSelect:t,choices:[{value:512,desc:"512 Samples"},{value:1024,desc:"1024 Samples"},{value:2048,desc:"2048 Samples"},{value:4096,desc:"4096 Samples"}]})}function ue(){var e=K((function(e){return e.detectorName})),t=_((function(e){return e.setDetectorName}));return Object(a.jsx)(oe,{selected:e,onSelect:t,choices:[{value:"mcleod",desc:"McLeod"},{value:"autocorrelation",desc:"Autocorrelation"}]})}function he(){var e=K((function(e){return e.clarityThreshold})),t=_((function(e){return e.setClarityThreshold}));return Object(a.jsx)(se.a,{children:Object(a.jsx)(se.a.Group,{children:Object(a.jsx)(se.a.Control,{type:"range",value:e,min:0,max:1,step:.01,onChange:function(e){return t(parseFloat(e.target.value))}})})})}function de(){var e=K((function(e){return e.displayType})),t=_((function(e){return e.setDisplayType}));return Object(a.jsx)(oe,{selected:e,onSelect:t,choices:[{value:"chart",desc:"Linear Chart"},{value:"circle",desc:"Circle Chart"}]})}function fe(e){var t=e.children,n=i.a.useState(!1),r=Object(D.a)(n,2),c=r[0],s=r[1],o=i.a.useState(!1),h=Object(D.a)(o,2),d=h[0],f=h[1],v=K((function(e){return e.clarityThreshold})),b=_((function(e){return e})),j=b.initializeStream,p=b.stopStream,g=b.setEnabled;return i.a.useEffect((function(){return d?Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:g(!0),console.log("Stream Initialized");case 4:case"end":return e.stop()}}),e)})))():Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!1),e.next=3,p();case 3:console.log("Stream Stopped");case 4:case"end":return e.stop()}}),e)})))(),p}),[j,d,g,p]),Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsx)(I.a,{bg:"primary",variant:"dark",children:Object(a.jsx)(I.a.Brand,{children:"Pitch Detector"})}),Object(a.jsxs)("div",{className:"main-container",children:[Object(a.jsxs)(re,{expanded:c,onToggle:s,children:[Object(a.jsx)($,{}),Object(a.jsxs)(re.Nav,{children:[Object(a.jsx)(ee,{className:d?"active":"",onClick:function(){f(!d)},children:d?Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsx)(te,{children:Object(a.jsx)(L.a,{size:"20"})}),Object(a.jsx)(ne,{children:"Stop"})]}):Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsx)(te,{children:Object(a.jsx)(W.a,{size:"20"})}),Object(a.jsx)(ne,{children:"Start"})]})}),Object(a.jsxs)(ee,{onClick:function(){s(!c)},children:[Object(a.jsx)(te,{children:Object(a.jsx)(G.a,{size:"20"})}),Object(a.jsx)(ne,{children:"Settings"})]}),Object(a.jsx)(ae,{children:Object(a.jsxs)(B.a,{variant:"flush",color:"primary",children:[Object(a.jsx)(B.a.Item,{children:Object(a.jsxs)("div",{className:"setting",children:[Object(a.jsx)("span",{className:"setting-desc",children:"Window Size"}),Object(a.jsx)(le,{})]})}),Object(a.jsx)(B.a.Item,{children:Object(a.jsxs)("div",{className:"setting",children:[Object(a.jsx)("span",{className:"setting-desc",children:"Detector"}),Object(a.jsx)(ue,{})]})}),Object(a.jsx)(B.a.Item,{children:Object(a.jsxs)("div",{className:"setting",children:[Object(a.jsxs)("span",{className:"setting-desc",children:["Clarity Threshold (",v,")"]}),Object(a.jsx)(he,{})]})}),Object(a.jsxs)(B.a.Item,{children:[Object(a.jsx)("div",{className:"setting",children:Object(a.jsx)("span",{className:"setting-desc",children:"Display Type"})}),Object(a.jsx)(de,{})]})]})}),Object(a.jsxs)(ee,{className:"mt-auto"+(d?"":" active"),onClick:function(){f(!1)},children:[Object(a.jsx)(te,{children:Object(a.jsx)(U.a,{size:"20"})}),Object(a.jsx)(ne,{children:"About"})]})]})]}),Object(a.jsx)("main",{role:"main",children:t})]})]})}function ve(){return Object(a.jsxs)("div",{className:"container",children:[Object(a.jsx)("h2",{children:"A Rust + WebAssembly Pitch Detector"}),Object(a.jsx)("h3",{children:"Authors"}),Object(a.jsx)("span",{children:"Alessandro Genova, Jason Siefken"}),Object(a.jsx)("h3",{children:"Core Library"}),Object(a.jsxs)("span",{children:[Object(a.jsx)("a",{href:"https://github.com/alesgenova/pitch-detection",target:"_blank",rel:"noreferrer",children:"Source"}),Object(a.jsx)("br",{}),"(rust)"]}),Object(a.jsx)("h3",{children:"Demo App"}),Object(a.jsxs)("span",{children:[Object(a.jsx)("a",{href:"https://github.com/alesgenova/pitch-detection-app",target:"_blank",rel:"noreferrer",children:"Source"}),Object(a.jsx)("br",{}),"(wasm, react)"]})]})}var be=function(){var e=K((function(e){return e.detectorName})),t=K((function(e){return e.windowSize})),n=K((function(e){return e.clarityThreshold})),r=K((function(e){return e.displayType})),c=K((function(e){return e.enabled})),s=K((function(e){return{loaded:e.loaded,loading:e.loading,stream:e.stream,workerConnection:e.workerConnection}})),o=s.loaded,h=s.stream,d=s.workerConnection,f=_((function(e){return e})).initializeWorker;i.a.useEffect((function(){Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:console.log("Worker initialized");case 3:case"end":return e.stop()}}),e)})))()}),[f]);var v=Object(a.jsx)(ve,{});if(o&&h&&d){var b="circle"===r?q:M;v=Object(a.jsx)(R,{stream:h,detectorName:e,workerConnection:d,windowSize:t,powerThreshold:.15,clarityThreshold:n,enabled:c,pitchRenderer:b})}return Object(a.jsx)(fe,{children:v})},je=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,119)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),i(e),c(e)}))};n(103);s.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(H.StoreProvider,{store:J,children:Object(a.jsx)(be,{})})}),document.getElementById("root")),je()},60:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u}));var a=100,r=5,i=4,c=6,s=11,o=6,l=6;function u(t){var n=[],u=function(e){return e.replace(/_/g,"+").replace(/\./g,"/").replace(/-/g,"=")}(t),h=e.from(u,"base64");if(h.length<2)throw new Error("No content");for(var d=0,f=h.readUInt16BE(0),v=0,b=2;b<h.length;){var j=void 0,p=void 0,g=void 0,m=void 0;if(128&h.readUIntBE(b,1)){j=3;var x=h.readUIntBE(b,j);p=x>>o+l&(1<<s)-1,g=x>>l&(1<<o)-1,m=x&(1<<l)-1&(1<<l)-1,d+=x}else{j=2;var y=h.readUIntBE(b,j);p=y>>i+c&(1<<r)-1,g=y>>c&(1<<i)-1,m=y&(1<<c)-1&(1<<c)-1,d+=y}var O={start:v+p*a,duration:g*a,pitch:m};n.push(O),v=O.start+O.duration,b+=j}if((65535&d)!==f)throw new Error("Corrupted data: invalid checksum");return n}}).call(this,n(86).Buffer)},74:function(e,t,n){},84:function(e,t){},97:function(e,t,n){}},[[104,1,2]]]);
//# sourceMappingURL=main.ade9abca.chunk.js.map